# Write-Up Stack-One

### The following code is given:

```C
/*
 * phoenix/stack-one, by https://exploit.education
 *
 * The aim is to change the contents of the changeme variable to 0x496c5962
 *
 * Did you hear about the kid napping at the local school?
 * It's okay, they woke up.
 *
 */

#include <err.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

#define BANNER \
  "Welcome to " LEVELNAME ", brought to you by https://exploit.education"

int main(int argc, char **argv) {
  struct {
    char buffer[64];
    volatile int changeme;
  } locals;

  printf("%s\n", BANNER);

  if (argc < 2) {
    errx(1, "specify an argument, to be copied into the \"buffer\"");
  }

  locals.changeme = 0;
  strcpy(locals.buffer, argv[1]);

  if (locals.changeme == 0x496c5962) {
    puts("Well done, you have successfully set changeme to the correct value");
  } else {
    printf("Getting closer! changeme is currently 0x%08x, we want 0x496c5962\n",
        locals.changeme);
  }

  exit(0);
}
```
# Solve

Reading the code we can notice that to solve this challenge we need to change locals.changeme to 0x496c5962, evidenced by the lines:

```C
if (locals.changeme == 0x496c5962) {
    puts("Well done, you have successfully set changeme to the correct value");
  } 
```
Looking at the code we see that we do not have any function that takes user input, but
we do have a way to input data.

```C
  locals.changeme = 0;
  strcpy(locals.buffer, argv[1]);

```
The lines above basically copy to **locals.buffer** the contents of argv[1].
Since we need to change **locals.changeme** to 0x496c5962 we will need to 
**corrupt** the buffer until we reach **locals.changeme** but we will need to use
the command-line when executing the program to do so.

So we could craft this little exploit with pwntools:
<p align="center">
  <img src="https://github.com/Mistersz/Write-Ups/assets/82767252/da838301-5e19-4b18-811a-77ee80eb5210"/>
</p>

We can see that the line:

```Python
target = process(['./stackone', payload + b"bYlI"])
```
Starts the program and in the sameline sends "bYlI" as input for argv[1]. The reason why thatÂ´s the input we can use
is that: Each of this caracters are equivalent to hexadecimal numbers in the ASCII table :

- b -> 0x62
- Y -> 0x59 
- l -> 0x6c
- I -> 0x49

We need to send in this particular order due the [**endianess**](https://en.wikipedia.org/wiki/Endianness) of the program. It will convert our input to little-endian, and receive 0x496c5962.

And then:

<p align="center">
  <img src="https://github.com/Mistersz/Write-Ups/assets/82767252/2c1eff8a-454b-44ba-a5d3-7ce19e52525a"/>
</p>






